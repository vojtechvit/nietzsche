(function(n){n.a=function(t,i){var r=t.split(".")[0];t=t.split(".")[1],n[r]=n[r]||{},n[r][t]=function(n,t){arguments.length&&this._setup(n,t)},n[r][t].prototype=n.extend({namespace:r,pluginName:t},i),n.fn[t]=function(i){var f=typeof i=="string",e=Array.prototype.slice.call(arguments,1),u=this;return f&&i.substring(0,1)==="_"?u:(this.each(function(){var o=n.data(this,t);o||(o=n.data(this,t,new n[r][t](i,this))),f&&(u=o[i].apply(o,e))}),u)}},n.a("ui.gmap",{options:{mapTypeId:"roadmap",zoom:5},option:function(n,t){return t?(this.options[n]=t,this.get("map").set(n,t),this):this.options[n]},_setup:function(n,t){this.el=t,n=n||{},jQuery.extend(this.options,n,{center:this._latLng(n.center)}),this._create(),this._init&&this._init()},_create:function(){var t=this;this.instance={map:new google.maps.Map(t.el,t.options),markers:[],overlays:[],services:[]},google.maps.event.addListenerOnce(t.instance.map,"bounds_changed",function(){n(t.el).trigger("init",t.instance.map)}),t._call(t.options.callback,t.instance.map)},addBounds:function(n){var t=this.get("bounds",new google.maps.LatLngBounds);return t.extend(this._latLng(n)),this.get("map").fitBounds(t),this},inViewport:function(n){var t=this.get("map").getBounds();return t?t.contains(n.getPosition()):!1},addControl:function(n,t){return this.get("map").controls[t].push(this._unwrap(n)),this},addMarker:function(t,i){t.map=this.get("map"),t.position=this._latLng(t.position);var r=new(t.marker||google.maps.Marker)(t),u=this.get("markers");return r.id?u[r.id]=r:u.push(r),r.bounds&&this.addBounds(r.getPosition()),this._call(i,t.map,r),n(r)},clear:function(n){return this._c(this.get(n)),this.set(n,[]),this},_c:function(n){for(var t in n)n.hasOwnProperty(t)&&(n[t]instanceof google.maps.MVCObject?(google.maps.event.clearInstanceListeners(n[t]),n[t].setMap&&n[t].setMap(null)):n[t]instanceof Array&&this._c(n[t]),n[t]=null)},find:function(t,i,r){var u=this.get(t),f,e,o;i.value=n.isArray(i.value)?i.value:[i.value];for(f in u)if(u.hasOwnProperty(f)){e=!1;for(o in i.value)if(n.inArray(i.value[o],u[f][i.property])>-1)e=!0;else if(i.operator&&i.operator==="AND"){e=!1;break}r(u[f],e)}return this},get:function(n,t){var i=this.instance,u,r;if(!i[n]){if(n.indexOf(">")>-1){for(u=n.replace(/ /g,"").split(">"),r=0;r<u.length;r++){if(!i[u[r]])if(t)i[u[r]]=r+1<u.length?[]:t;else return null;i=i[u[r]]}return i}t&&!i[n]&&this.set(n,t)}return i[n]},openInfoWindow:function(n,t,i){var r=this.get("iw",n.infoWindow||new google.maps.InfoWindow);return r.setOptions(n),r.open(this.get("map"),this._unwrap(t)),this._call(i,r),this},closeInfoWindow:function(){return this.get("iw")!=null&&this.get("iw").close(),this},set:function(n,t){return this.instance[n]=t,this},refresh:function(){var t=this.get("map"),i=t.getCenter();return n(t).triggerEvent("resize"),t.setCenter(i),this},destroy:function(){this.clear("markers").clear("services").clear("overlays")._c(this.instance),jQuery.removeData(this.el,this.name)},_call:function(t){t&&n.isFunction(t)&&t.apply(this,Array.prototype.slice.call(arguments,1))},_latLng:function(n){return n?n instanceof google.maps.LatLng?n:(n=n.replace(/ /g,"").split(","),new google.maps.LatLng(n[0],n[1])):new google.maps.LatLng(0,0)},_unwrap:function(t){return t?t instanceof jQuery?t[0]:t instanceof Object?t:n("#"+t)[0]:null}}),jQuery.fn.extend({triggerEvent:function(n){return google.maps.event.trigger(this[0],n),this},addEventListener:function(n,t,i){return google.maps&&this[0]instanceof google.maps.MVCObject?google.maps.event.addListener(this[0],n,t):i?this.bind(n,t,i):this.bind(n,t),this}}),jQuery.each("click rightclick dblclick mouseover mouseout drag dragend".split(" "),function(n,t){jQuery.fn[t]=function(n,i){return this.addEventListener(t,n,i)}})})(jQuery);